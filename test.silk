type result:<$a, $b> = struct(Ok $a, Error $b);

func result_bind:<$a, $b>(v result:<$a, $b>, f func ($a) result:<$a, $b>) result:<$a, $b> {
  var as = [$a; 1];
  var a = as[0];
  if bool(a = v.Ok) {
    return f(a);
  }
  return v;
}

func incr(a i32) result:<i32, *i8> { return result:<i32, *i8>(a + 1, "nil"); }

func main() void {
  var asdf = "hello";
  if (asdf = "world") != "hello" {
    result_bind:<i32, *i8>(result:<i32, *i8>(1, asdf), incr);
  }
}
